<div class="title"><h1>Projet {{currentProjectId}}</h1> <button mat-button (click)="Analyse()">Analyser</button></div>
<section class="configuration">
  <br />
  <div *ngIf="edit === true">
    <!-- The repository to use -->
    <mat-form-field *ngIf="project != null">
      <mat-select [(ngModel)]="project.repositoryId">
        <mat-option>--Dépot--</mat-option>
        <mat-option *ngFor="let repo of repositories" [value]="repo.name">{{repo.name}}</mat-option>
      </mat-select>
    </mat-form-field><br />
    <!-- Command to prepare files -->
    <mat-form-field *ngIf="project != null">
      <mat-label>Commande de préparation</mat-label>
      <textarea matInput [(ngModel)]="project.commandLinesBeforeParse"></textarea>
    </mat-form-field>
  </div>
  <div *ngIf="edit === false && project != null">
    <table class="biutifulTable">
      <tr>
        <th>Dépot</th>
        <th>{{project.repositoryId}}</th>
      </tr>
      <tr>
        <th>Commande de préparation</th>
        <th>{{project.commandLinesBeforeParse}}</th>
      </tr>
    </table>
  </div>
  <div class="buttons">
    <button mat-button *ngIf="edit === false" (click)="EditProject()">Modifier la configuration de {{currentProjectId}}</button>
    <button mat-button *ngIf="edit === true" (click)="UpdateProject()">Sauvegarder</button>
  </div>
</section>
<hr/>
<section>
  <h2>Packages trouvés pour le projet</h2>
  <div>
    <a [href]="GetCsvUrl()" [download]="currentProjectId + '.csv'">Télécharger le fichier csv</a><br />

    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Ex. ium">
    </mat-form-field><br />

    <!-- Display list of packages found -->
    <table *ngIf="project != null" mat-table [dataSource]="packages" matSort class="mat-elevation-z8">
      <!-- Package Id -->
      <ng-container matColumnDef="packageId">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
        <td mat-cell *matCellDef="let element"> {{element.packageId}} </td>
      </ng-container>

      <!-- Package Version -->
      <ng-container matColumnDef="version">
        <th mat-header-cell *matHeaderCellDef> Version </th>
        <td mat-cell *matCellDef="let element"> {{element.version}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  </div>
</section>
